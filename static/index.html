<!-- 接続すると最初に表示されるページ -->
<script type=text/javascript src="script/fetchJSON.js"></script> 
<script type=text/javascript src="script/board.js"></script>


<div id=board></div>
            
<div class=writebox>
    名前：<input type=text id=inp_name><br>コメント<br>
    <textarea id=inp_body></textarea><br>
    <button id="write">書き込む</button>
</div>

<div class=loginbox>
    ID：<input type=text id=inp_ID><br>
    password：<input type=text id=inp_pass>
    <button id="login">login</button>
</div>

<script type=module>
    import {hash} from "https://js.sabae.cc/hash.js"

    window.onload = async () => {
        console.log("load");
        load_board();
    };
    
    write.onclick=async()=>{
        console.log("add");
        add_board();
    };
    
    login.onclick=()=>{
        console.log("click");
    }

    login.onclick=async()=>{
        const item = {
            ID: inp_ID.value.trim(),
            pass: hash(inp_pass.value)
        };
        console.log("item :",item);
        const res=await fetchJSON("api/login",item);
        console.log("res :",res);
        if (!res || res=="not found"){
            alert("ユーザー登録またはログインに失敗しました");
            return;
        }
        alert("ログインに成功しました。");
        console.log(res)
    }
    
    
</script>
